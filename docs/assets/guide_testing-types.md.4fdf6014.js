import{_ as s,j as n,k as a,V as p}from"./chunks/framework.cf42e605.js";const D=JSON.parse('{"title":"Testing Types | Guide","description":"","frontmatter":{"title":"Testing Types | Guide"},"headers":[],"relativePath":"guide/testing-types.md","filePath":"guide/testing-types.md","lastUpdated":1680421690000}'),e={name:"guide/testing-types.md"},o=p(`<h1 id="testing-types" tabindex="-1">Testing Types <a class="header-anchor" href="#testing-types" aria-label="Permalink to &quot;Testing Types&quot;">​</a></h1><p>Vitest allows you to write tests for your types, using <code>expectTypeOf</code> or <code>assertType</code> syntaxes. By default all tests inside <code>*.test-d.ts</code> files are considered type tests, but you can change it with <a href="/config/#typecheck-include"><code>typecheck.include</code></a> config option.</p><p>Under the hood Vitest calls <code>tsc</code> or <code>vue-tsc</code>, depending on your config, and parses results. Vitest will also print out type errors in your source code, if it finds any. You can disable it with <a href="/config/#typecheck-ignoresourceerrors"><code>typecheck.ignoreSourceErrors</code></a> config option.</p><p>Keep in mind that Vitest doesn&#39;t run or compile these files, they are only statically analyzed by the compiler, and because of that you cannot use any dynamic statements. Meaning, you cannot use dynamic test names, and <code>test.each</code>, <code>test.runIf</code>, <code>test.skipIf</code>, <code>test.concurrent</code> APIs. But you can use other APIs, like <code>test</code>, <code>describe</code>, <code>.only</code>, <code>.skip</code> and <code>.todo</code>.</p><p>Using CLI flags, like <code>--allowOnly</code> and <code>-t</code> are also supported for type checking.</p><div class="language-ts vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">ts</span><pre class="shiki vitesse-dark vp-code-dark"><code><span class="line"><span style="color:#4D9375;">import</span><span style="color:#DBD7CAEE;"> </span><span style="color:#666666;">{</span><span style="color:#DBD7CAEE;"> </span><span style="color:#BD976A;">assertType</span><span style="color:#666666;">,</span><span style="color:#DBD7CAEE;"> </span><span style="color:#BD976A;">expectTypeOf</span><span style="color:#DBD7CAEE;"> </span><span style="color:#666666;">}</span><span style="color:#DBD7CAEE;"> </span><span style="color:#4D9375;">from</span><span style="color:#DBD7CAEE;"> </span><span style="color:#C98A7D99;">&#39;</span><span style="color:#C98A7D;">vitest</span><span style="color:#C98A7D99;">&#39;</span></span>
<span class="line"><span style="color:#4D9375;">import</span><span style="color:#DBD7CAEE;"> </span><span style="color:#666666;">{</span><span style="color:#DBD7CAEE;"> </span><span style="color:#BD976A;">mount</span><span style="color:#DBD7CAEE;"> </span><span style="color:#666666;">}</span><span style="color:#DBD7CAEE;"> </span><span style="color:#4D9375;">from</span><span style="color:#DBD7CAEE;"> </span><span style="color:#C98A7D99;">&#39;</span><span style="color:#C98A7D;">./mount.js</span><span style="color:#C98A7D99;">&#39;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#80A665;">test</span><span style="color:#666666;">(</span><span style="color:#C98A7D99;">&#39;</span><span style="color:#C98A7D;">my types work properly</span><span style="color:#C98A7D99;">&#39;</span><span style="color:#666666;">,</span><span style="color:#DBD7CAEE;"> </span><span style="color:#666666;">()</span><span style="color:#DBD7CAEE;"> </span><span style="color:#666666;">=&gt;</span><span style="color:#DBD7CAEE;"> </span><span style="color:#666666;">{</span></span>
<span class="line"><span style="color:#DBD7CAEE;">  </span><span style="color:#80A665;">expectTypeOf</span><span style="color:#666666;">(</span><span style="color:#BD976A;">mount</span><span style="color:#666666;">).</span><span style="color:#80A665;">toBeFunction</span><span style="color:#666666;">()</span></span>
<span class="line"><span style="color:#DBD7CAEE;">  </span><span style="color:#80A665;">expectTypeOf</span><span style="color:#666666;">(</span><span style="color:#BD976A;">mount</span><span style="color:#666666;">).</span><span style="color:#80A665;">parameter</span><span style="color:#666666;">(</span><span style="color:#4C9A91;">0</span><span style="color:#666666;">).</span><span style="color:#80A665;">toMatchTypeOf</span><span style="color:#666666;">&lt;{</span><span style="color:#DBD7CAEE;"> </span><span style="color:#BD976A;">name</span><span style="color:#666666;">: </span><span style="color:#5DA994;">string</span><span style="color:#666666;"> }&gt;()</span></span>
<span class="line"></span>
<span class="line"><span style="color:#666666;">  </span><span style="color:#758575DD;">// @ts-expect-error name is a string</span></span>
<span class="line"><span style="color:#DBD7CAEE;">  </span><span style="color:#80A665;">assertType</span><span style="color:#666666;">(</span><span style="color:#80A665;">mount</span><span style="color:#666666;">({ </span><span style="color:#B8A965;">name</span><span style="color:#666666;">: </span><span style="color:#4C9A91;">42</span><span style="color:#666666;"> }))</span></span>
<span class="line"><span style="color:#666666;">})</span></span></code></pre><pre class="shiki vitesse-light vp-code-light"><code><span class="line"><span style="color:#1E754F;">import</span><span style="color:#393A34;"> </span><span style="color:#999999;">{</span><span style="color:#393A34;"> </span><span style="color:#B07D48;">assertType</span><span style="color:#999999;">,</span><span style="color:#393A34;"> </span><span style="color:#B07D48;">expectTypeOf</span><span style="color:#393A34;"> </span><span style="color:#999999;">}</span><span style="color:#393A34;"> </span><span style="color:#1E754F;">from</span><span style="color:#393A34;"> </span><span style="color:#B5695999;">&#39;</span><span style="color:#B56959;">vitest</span><span style="color:#B5695999;">&#39;</span></span>
<span class="line"><span style="color:#1E754F;">import</span><span style="color:#393A34;"> </span><span style="color:#999999;">{</span><span style="color:#393A34;"> </span><span style="color:#B07D48;">mount</span><span style="color:#393A34;"> </span><span style="color:#999999;">}</span><span style="color:#393A34;"> </span><span style="color:#1E754F;">from</span><span style="color:#393A34;"> </span><span style="color:#B5695999;">&#39;</span><span style="color:#B56959;">./mount.js</span><span style="color:#B5695999;">&#39;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#59873A;">test</span><span style="color:#999999;">(</span><span style="color:#B5695999;">&#39;</span><span style="color:#B56959;">my types work properly</span><span style="color:#B5695999;">&#39;</span><span style="color:#999999;">,</span><span style="color:#393A34;"> </span><span style="color:#999999;">()</span><span style="color:#393A34;"> </span><span style="color:#999999;">=&gt;</span><span style="color:#393A34;"> </span><span style="color:#999999;">{</span></span>
<span class="line"><span style="color:#393A34;">  </span><span style="color:#59873A;">expectTypeOf</span><span style="color:#999999;">(</span><span style="color:#B07D48;">mount</span><span style="color:#999999;">).</span><span style="color:#59873A;">toBeFunction</span><span style="color:#999999;">()</span></span>
<span class="line"><span style="color:#393A34;">  </span><span style="color:#59873A;">expectTypeOf</span><span style="color:#999999;">(</span><span style="color:#B07D48;">mount</span><span style="color:#999999;">).</span><span style="color:#59873A;">parameter</span><span style="color:#999999;">(</span><span style="color:#2F798A;">0</span><span style="color:#999999;">).</span><span style="color:#59873A;">toMatchTypeOf</span><span style="color:#999999;">&lt;{</span><span style="color:#393A34;"> </span><span style="color:#B07D48;">name</span><span style="color:#999999;">: </span><span style="color:#2E8F82;">string</span><span style="color:#999999;"> }&gt;()</span></span>
<span class="line"></span>
<span class="line"><span style="color:#999999;">  </span><span style="color:#A0ADA0;">// @ts-expect-error name is a string</span></span>
<span class="line"><span style="color:#393A34;">  </span><span style="color:#59873A;">assertType</span><span style="color:#999999;">(</span><span style="color:#59873A;">mount</span><span style="color:#999999;">({ </span><span style="color:#998418;">name</span><span style="color:#999999;">: </span><span style="color:#2F798A;">42</span><span style="color:#999999;"> }))</span></span>
<span class="line"><span style="color:#999999;">})</span></span></code></pre></div><p>Any type error triggered inside a test file will be treated as a test error, so you can use any type trick you want to test types of your project.</p><p>You can see a list of possible matchers in <a href="/api/expect-typeof.html">API section</a>.</p><h2 id="reading-errors" tabindex="-1">Reading Errors <a class="header-anchor" href="#reading-errors" aria-label="Permalink to &quot;Reading Errors&quot;">​</a></h2><p>If you are using <code>expectTypeOf</code> API, you might notice hard to read errors or unexpected:</p><div class="language-ts vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">ts</span><pre class="shiki vitesse-dark vp-code-dark"><code><span class="line"><span style="color:#80A665;">expectTypeOf</span><span style="color:#666666;">(</span><span style="color:#4C9A91;">1</span><span style="color:#666666;">).</span><span style="color:#80A665;">toEqualTypeOf</span><span style="color:#666666;">&lt;</span><span style="color:#5DA994;">string</span><span style="color:#666666;">&gt;()</span></span>
<span class="line"><span style="color:#758575DD;">//             ^^^^^^^^^^^^^^^^^^^^^^</span></span>
<span class="line"><span style="color:#758575DD;">// index-c3943160.d.ts(90, 20): Arguments for the rest parameter &#39;MISMATCH&#39; were not provided.</span></span></code></pre><pre class="shiki vitesse-light vp-code-light"><code><span class="line"><span style="color:#59873A;">expectTypeOf</span><span style="color:#999999;">(</span><span style="color:#2F798A;">1</span><span style="color:#999999;">).</span><span style="color:#59873A;">toEqualTypeOf</span><span style="color:#999999;">&lt;</span><span style="color:#2E8F82;">string</span><span style="color:#999999;">&gt;()</span></span>
<span class="line"><span style="color:#A0ADA0;">//             ^^^^^^^^^^^^^^^^^^^^^^</span></span>
<span class="line"><span style="color:#A0ADA0;">// index-c3943160.d.ts(90, 20): Arguments for the rest parameter &#39;MISMATCH&#39; were not provided.</span></span></code></pre></div><p>This is due to how <a href="https://github.com/mmkal/expect-type" target="_blank" rel="noreferrer"><code>expect-type</code></a> handles type errors.</p><p>Unfortunately, TypeScript doesn&#39;t provide type metadata without patching, so we cannot provide useful error messages at this point, but there are <a href="https://github.com/microsoft/TypeScript/pull/40468" target="_blank">works in TypeScript project</a> to fix this. If you want better messages, please, ask TypeScript team to have a look at mentioned PR.</p><p>If you find it hard working with <code>expectTypeOf</code> API and figuring out errors, you can always use more simple <code>assertType</code> API:</p><div class="language-ts vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">ts</span><pre class="shiki vitesse-dark vp-code-dark"><code><span class="line"><span style="color:#CB7676;">const </span><span style="color:#BD976A;">answer</span><span style="color:#CB7676;"> </span><span style="color:#666666;">=</span><span style="color:#CB7676;"> </span><span style="color:#4C9A91;">42</span></span>
<span class="line"></span>
<span class="line"><span style="color:#80A665;">assertType</span><span style="color:#666666;">&lt;</span><span style="color:#5DA994;">number</span><span style="color:#666666;">&gt;(</span><span style="color:#BD976A;">answer</span><span style="color:#666666;">)</span></span>
<span class="line"><span style="color:#758575DD;">// @ts-expect-error answer is not a string</span></span>
<span class="line"><span style="color:#80A665;">assertType</span><span style="color:#666666;">&lt;</span><span style="color:#5DA994;">string</span><span style="color:#666666;">&gt;(</span><span style="color:#BD976A;">answer</span><span style="color:#666666;">)</span></span></code></pre><pre class="shiki vitesse-light vp-code-light"><code><span class="line"><span style="color:#AB5959;">const </span><span style="color:#B07D48;">answer</span><span style="color:#AB5959;"> </span><span style="color:#999999;">=</span><span style="color:#AB5959;"> </span><span style="color:#2F798A;">42</span></span>
<span class="line"></span>
<span class="line"><span style="color:#59873A;">assertType</span><span style="color:#999999;">&lt;</span><span style="color:#2E8F82;">number</span><span style="color:#999999;">&gt;(</span><span style="color:#B07D48;">answer</span><span style="color:#999999;">)</span></span>
<span class="line"><span style="color:#A0ADA0;">// @ts-expect-error answer is not a string</span></span>
<span class="line"><span style="color:#59873A;">assertType</span><span style="color:#999999;">&lt;</span><span style="color:#2E8F82;">string</span><span style="color:#999999;">&gt;(</span><span style="color:#B07D48;">answer</span><span style="color:#999999;">)</span></span></code></pre></div><div class="tip custom-block"><p class="custom-block-title">TIP</p><p>When using <code>@ts-expect-error</code> syntax, you might want to make sure that you didn&#39;t make a typo. You can do that by including your type files in <a href="/config/#include"><code>test.include</code></a> config option, so Vitest will also actually <em>run</em> these tests and fail with <code>ReferenceError</code>.</p><p>This will pass, because it expects an error, but the word “answer” has a typo, so it&#39;s a false positive error:</p><div class="language-ts vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">ts</span><pre class="shiki vitesse-dark vp-code-dark"><code><span class="line"><span style="color:#758575DD;">// @ts-expect-error answer is not a string</span></span>
<span class="line"><span style="color:#80A665;">assertType</span><span style="color:#666666;">&lt;</span><span style="color:#5DA994;">string</span><span style="color:#666666;">&gt;(</span><span style="color:#BD976A;">answr</span><span style="color:#666666;">)</span><span style="color:#DBD7CAEE;"> </span><span style="color:#758575DD;">//</span></span></code></pre><pre class="shiki vitesse-light vp-code-light"><code><span class="line"><span style="color:#A0ADA0;">// @ts-expect-error answer is not a string</span></span>
<span class="line"><span style="color:#59873A;">assertType</span><span style="color:#999999;">&lt;</span><span style="color:#2E8F82;">string</span><span style="color:#999999;">&gt;(</span><span style="color:#B07D48;">answr</span><span style="color:#999999;">)</span><span style="color:#393A34;"> </span><span style="color:#A0ADA0;">//</span></span></code></pre></div></div><h2 id="run-typechecking" tabindex="-1">Run typechecking <a class="header-anchor" href="#run-typechecking" aria-label="Permalink to &quot;Run typechecking&quot;">​</a></h2><p>Add this command to your <code>scripts</code> section in <code>package.json</code>:</p><div class="language-json vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">json</span><pre class="shiki vitesse-dark vp-code-dark"><code><span class="line"><span style="color:#666666;">{</span></span>
<span class="line"><span style="color:#DBD7CAEE;">  </span><span style="color:#C98A7D99;">&quot;</span><span style="color:#B8A965;">scripts</span><span style="color:#C98A7D99;">&quot;</span><span style="color:#666666;">:</span><span style="color:#DBD7CAEE;"> </span><span style="color:#666666;">{</span></span>
<span class="line"><span style="color:#DBD7CAEE;">    </span><span style="color:#C98A7D99;">&quot;</span><span style="color:#B8A965;">typecheck</span><span style="color:#C98A7D99;">&quot;</span><span style="color:#666666;">:</span><span style="color:#DBD7CAEE;"> </span><span style="color:#C98A7D99;">&quot;</span><span style="color:#C98A7D;">vitest typecheck</span><span style="color:#C98A7D99;">&quot;</span></span>
<span class="line"><span style="color:#DBD7CAEE;">  </span><span style="color:#666666;">}</span></span>
<span class="line"><span style="color:#666666;">}</span></span></code></pre><pre class="shiki vitesse-light vp-code-light"><code><span class="line"><span style="color:#999999;">{</span></span>
<span class="line"><span style="color:#393A34;">  </span><span style="color:#B5695999;">&quot;</span><span style="color:#998418;">scripts</span><span style="color:#B5695999;">&quot;</span><span style="color:#999999;">:</span><span style="color:#393A34;"> </span><span style="color:#999999;">{</span></span>
<span class="line"><span style="color:#393A34;">    </span><span style="color:#B5695999;">&quot;</span><span style="color:#998418;">typecheck</span><span style="color:#B5695999;">&quot;</span><span style="color:#999999;">:</span><span style="color:#393A34;"> </span><span style="color:#B5695999;">&quot;</span><span style="color:#B56959;">vitest typecheck</span><span style="color:#B5695999;">&quot;</span></span>
<span class="line"><span style="color:#393A34;">  </span><span style="color:#999999;">}</span></span>
<span class="line"><span style="color:#999999;">}</span></span></code></pre></div><p>Now you can run typecheck:</p><div class="language-sh vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">sh</span><pre class="shiki vitesse-dark vp-code-dark"><code><span class="line"><span style="color:#758575DD;"># npm</span></span>
<span class="line"><span style="color:#80A665;">npm</span><span style="color:#DBD7CAEE;"> </span><span style="color:#C98A7D;">run</span><span style="color:#DBD7CAEE;"> </span><span style="color:#C98A7D;">typecheck</span></span>
<span class="line"></span>
<span class="line"><span style="color:#758575DD;"># yarn</span></span>
<span class="line"><span style="color:#80A665;">yarn</span><span style="color:#DBD7CAEE;"> </span><span style="color:#C98A7D;">typecheck</span></span>
<span class="line"></span>
<span class="line"><span style="color:#758575DD;"># pnpm</span></span>
<span class="line"><span style="color:#80A665;">pnpm</span><span style="color:#DBD7CAEE;"> </span><span style="color:#C98A7D;">run</span><span style="color:#DBD7CAEE;"> </span><span style="color:#C98A7D;">typecheck</span></span></code></pre><pre class="shiki vitesse-light vp-code-light"><code><span class="line"><span style="color:#A0ADA0;"># npm</span></span>
<span class="line"><span style="color:#59873A;">npm</span><span style="color:#393A34;"> </span><span style="color:#B56959;">run</span><span style="color:#393A34;"> </span><span style="color:#B56959;">typecheck</span></span>
<span class="line"></span>
<span class="line"><span style="color:#A0ADA0;"># yarn</span></span>
<span class="line"><span style="color:#59873A;">yarn</span><span style="color:#393A34;"> </span><span style="color:#B56959;">typecheck</span></span>
<span class="line"></span>
<span class="line"><span style="color:#A0ADA0;"># pnpm</span></span>
<span class="line"><span style="color:#59873A;">pnpm</span><span style="color:#393A34;"> </span><span style="color:#B56959;">run</span><span style="color:#393A34;"> </span><span style="color:#B56959;">typecheck</span></span></code></pre></div><p>Vitest uses <code>tsc --noEmit</code> or <code>vue-tsc --noEmit</code>, depending on your configuration, so you can remove these scripts from your pipeline.</p>`,22),l=[o];function t(c,r,y,i,d,A){return n(),a("div",null,l)}const h=s(e,[["render",t]]);export{D as __pageData,h as default};
